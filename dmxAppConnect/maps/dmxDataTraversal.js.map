{"version":3,"sources":["components/dataView.js","components/dataDetail.js","components/dataIterator.js"],"names":["dmx","Component","initialData","data","page","pages","items","sort","on","dir","has","first","prev","next","last","attributes","type","Array","Object","default","filter","String","Number","pageSize","sortOn","sortDir","validate","val","test","methods","select","this","setPage","prop","props","toLowerCase","_update","render","node","BaseComponent","prototype","call","update","JSON","stringify","setData","filtered","slice","item","parse","DataScope","a","b","reverse","length","set","Math","ceil","isArray","map","$value","key","push","$key","splice","tag","value","index","findIndex","loop","Boolean","random","console","warn","floor","parseInt"],"mappings":"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","file":"../dmxDataTraversal/dmxDataTraversal.js","sourcesContent":["dmx.Component('data-view', {\r\n\r\n    initialData: function() {\r\n        return {\r\n            data: [],\r\n            page: 1,\r\n            pages: 1,\r\n            items: 0,\r\n            sort: {\r\n                on: '',\r\n                dir: 'asc'\r\n            },\r\n            has: {\r\n                first: false,\r\n                prev: false,\r\n                next: false,\r\n                last: false\r\n            }\r\n        };\r\n    },\r\n\r\n    attributes: {\r\n        data: {\r\n            type: [Array, Object],\r\n            default: []\r\n        },\r\n\r\n        filter: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n\r\n        page: {\r\n            type: Number,\r\n            default: 1\r\n        },\r\n\r\n        pageSize: {\r\n            type: Number,\r\n            default: 0\r\n        },\r\n\r\n        sortOn: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n\r\n        sortDir: {\r\n            type: String,\r\n            default: 'asc',\r\n            validate: function(val) {\r\n                return /^(asc|desc)$/i.test(val);\r\n            }\r\n        }\r\n    },\r\n\r\n    methods: {\r\n        select: function(page) {\r\n            this.setPage(Number(page));\r\n        },\r\n\r\n        first: function() {\r\n            this.page = 1;\r\n            this.setPage(1);\r\n        },\r\n\r\n        prev: function() {\r\n            var page = this.page - 1;\r\n            if (page < 1) page = 1;\r\n            if (page > this.data.pages) page = this.data.pages;\r\n            this.page = page;\r\n            this.setPage(page);\r\n        },\r\n\r\n        next: function() {\r\n            var page = this.page + 1;\r\n            if (page < 1) page = 1;\r\n            if (page > this.data.pages) page = this.data.pages;\r\n            this.page = page;\r\n            this.setPage(page);\r\n        },\r\n\r\n        last: function() {\r\n            var page = this.data.pages;\r\n            this.page = page;\r\n            this.setPage(page);\r\n        },\r\n\r\n        sort: function(prop, dir) {\r\n            this.props.sortOn = prop;\r\n            this.props.sortDir = (dir && dir.toLowerCase() == 'desc' ? 'desc' : 'asc');\r\n            this._update();\r\n        }\r\n    },\r\n\r\n    render: function(node) {\r\n        dmx.BaseComponent.prototype.render.call(this, node);\r\n        this.update({});\r\n    },\r\n\r\n    update: function(props) {\r\n        if (JSON.stringify(this.props) != JSON.stringify(props)) {\r\n            if (JSON.stringify(this.props.data) != JSON.stringify(props.data)) {\r\n                this.setData(this.props.data);\r\n            }\r\n            if (this.props.page != props.page) {\r\n                this.page = this.props.page;\r\n            }\r\n        }\r\n\r\n        this._update();\r\n    },\r\n\r\n    _update: function() {\r\n        var filter = this.props.filter;\r\n        var sortOn = this.props.sortOn;\r\n        var sortDir = this.props.sortDir.toLowerCase();\r\n        var pageSize = this.props.pageSize;\r\n\r\n        this.filtered = this.items.slice(0);\r\n\r\n        if (filter) {\r\n            this.filtered = this.filtered.filter(function(item) {\r\n                return dmx.parse(this.props.filter, dmx.DataScope(item));\r\n            }, this);\r\n        }\r\n\r\n        if (sortOn) {\r\n            this.filtered.sort(function(a, b) {\r\n                return a[sortOn] < b[sortOn] ? -1 : a[sortOn] > b[sortOn] ? 1 : 0;\r\n            });\r\n        }\r\n\r\n        if (sortDir == 'desc') {\r\n            this.filtered.reverse();\r\n        }\r\n\r\n        if (this.filtered.length) {\r\n            this.set('pages', pageSize ? Math.ceil(this.filtered.length / pageSize) : 1);\r\n        } else {\r\n            this.set('pages', 1);\r\n        }\r\n\r\n        this.set('items', this.filtered.length);\r\n        this.set('sort', {\r\n            on: sortOn,\r\n            dir: sortDir\r\n        });\r\n\r\n        this.setPage(this.page);\r\n    },\r\n\r\n    setData: function(data) {\r\n        this.items = [];\r\n\r\n        if (data && typeof data == 'object') {\r\n            if (Array.isArray(data)) {\r\n                this.items = data.map(function(item) {\r\n                    return (typeof item === 'object') ? item : { $value: item };\r\n                });\r\n            } else {\r\n                for (var key in data) {\r\n                    this.items.push({ $key: key, $value: data[key] });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    setPage: function(page) {\r\n        var pageSize = +this.props.pageSize;\r\n        var data = this.filtered.slice(0);\r\n        if (page < 1) page = 1;\r\n        if (page > this.data.pages) page = this.data.pages;\r\n        //this.page = page;\r\n        this.set('page', page);\r\n        this.set('data', pageSize ? data.splice((page - 1) * pageSize, pageSize) : data);\r\n        this.set('has', {\r\n            first: page > 1,\r\n            prev: page > 1,\r\n            next: page < this.data.pages,\r\n            last: page < this.data.pages\r\n        });\r\n    }\r\n\r\n});\r\n","dmx.Component('data-detail', {\r\n\r\n    initialData: function() {\r\n        return {\r\n            data: {}\r\n        };\r\n    },\r\n\r\n    tag: 'div',\r\n\r\n    attributes: {\r\n        data: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n\r\n        key: {\r\n            type: String\r\n        },\r\n\r\n        value: {\r\n            type: [String, Number]\r\n        }\r\n    },\r\n\r\n    methods: {\r\n        select: function(value) {\r\n            this.props.value = value;\r\n            this.select(value);\r\n        }\r\n    },\r\n\r\n    render: function(node) {\r\n        this.items = [];\r\n        dmx.BaseComponent.prototype.render.call(this, node);\r\n        this.setData(this.props.data);\r\n        this.select(this.props.value);\r\n    },\r\n\r\n    update: function(props) {\r\n        if (JSON.stringify(props.data) !== JSON.stringify(this.props.data)) {\r\n            this.setData(this.props.data);\r\n            this.select(this.props.value);\r\n        }\r\n\r\n        if (props.value !== this.props.value) {\r\n            this.select(this.props.value);\r\n        }\r\n    },\r\n\r\n    setData: function(data) {\r\n        this.items = [];\r\n\r\n        if (data && typeof data == 'object') {\r\n            if (Array.isArray(data)) {\r\n                this.items = data.map(function(item) {\r\n                    return (typeof item === 'object') ? item : { $value: item };\r\n                });\r\n            } else {\r\n                for (var key in data) {\r\n                    this.items.push({ $key: key, $value: data[key] });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    select: function(value) {\r\n        var index = this.items.findIndex(function(item) {\r\n            return item[this.props.key] === this.props.value;\r\n        }, this);\r\n\r\n        this.set('data', this.items[index] || null);\r\n    }\r\n\r\n});\r\n","dmx.Component('data-iterator', {\r\n\r\n    initialData: function() {\r\n        return {\r\n            index: -1,\r\n            value: null,\r\n            has: {\r\n                first: false,\r\n                prev: false,\r\n                next: false,\r\n                last: false\r\n            }\r\n        };\r\n    },\r\n\r\n    tag: 'div',\r\n\r\n    attributes: {\r\n        data: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n\r\n        index: {\r\n            type: Number,\r\n            default: 0\r\n        },\r\n\r\n        loop: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n\r\n    methods: {\r\n        first: function() {\r\n            this.first();\r\n        },\r\n\r\n        prev: function() {\r\n            this.prev();\r\n        },\r\n\r\n        next: function() {\r\n            this.next();\r\n        },\r\n\r\n        last: function() {\r\n            this.last();\r\n        },\r\n\r\n        random: function() {\r\n            this.random();\r\n        },\r\n\r\n        select: function(index) {\r\n            this.select(index);\r\n        }\r\n    },\r\n\r\n    render: function(node) {\r\n        this.items = [];\r\n        dmx.BaseComponent.prototype.render.call(this, node);\r\n        this.setData(this.props.data);\r\n        this.select(this.props.index);\r\n    },\r\n\r\n    update: function(props) {\r\n        if (JSON.stringify(props.data) !== JSON.stringify(this.props.data)) {\r\n            this.setData(this.props.data);\r\n            this.select(this.props.index);\r\n        }\r\n\r\n        if (props.index !== this.props.index) {\r\n            this.select(this.props.index);\r\n        }\r\n    },\r\n\r\n    setData: function(data) {\r\n        if (data) {\r\n            if (Array.isArray(data)) {\r\n                this.items = data;\r\n            } else {\r\n                console.warn('Iterator data is not array but a ' + (typeof data));\r\n            }\r\n        }\r\n    },\r\n\r\n    first: function() {\r\n        if (this.items.length) {\r\n            this.select(0);\r\n        }\r\n    },\r\n\r\n    prev: function() {\r\n        if (this.items.length) {\r\n            index = this.data.index - 1;\r\n            if (index < 0 && this.props.loop) {\r\n                index = this.items.length - 1;\r\n            }\r\n            this.select(index);\r\n        }\r\n    },\r\n\r\n    next: function() {\r\n        if (this.items.length) {\r\n            index = this.data.index + 1;\r\n            if (index >= this.items.length && this.props.loop) {\r\n                index = 0;\r\n            }\r\n            this.select(index);\r\n        }\r\n    },\r\n\r\n    last: function() {\r\n        if (this.items.length) {\r\n            this.select(this.items.length - 1);\r\n        }\r\n    },\r\n\r\n    random: function() {\r\n        if (this.items.length) {\r\n            this.select(Math.floor(this.items.length * Math.random()));\r\n        }\r\n    },\r\n\r\n    select: function(index) {\r\n        index = parseInt(index, 10);\r\n\r\n        if (this.items.length) {\r\n            var last = this.items.length - 1;\r\n            if (index < 0) index = 0;\r\n            if (index >= this.items.length) index = last;\r\n            this.set('index', index);\r\n            this.set('value', this.items[index]);\r\n            this.set('has', {\r\n                first: index > 0,\r\n                prev: index > 0,\r\n                next: index < last,\r\n                last: index < last\r\n            });\r\n        } else {\r\n            this.set('index', -1);\r\n            this.set('value', null);\r\n            this.set('has', {\r\n                first: false,\r\n                prev: false,\r\n                next: false,\r\n                last: false\r\n            });\r\n        }\r\n    }\r\n\r\n});\r\n"]}